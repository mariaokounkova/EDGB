Notebook[{

Cell[CellGroupData[{
Cell["\<\
Numerical solutions for scalar in dCS/EdGB in Kerr BG with arbitrary a\
\>", "Section",ExpressionUUID->"b66e0b50-a0fd-4aaa-8f07-b1755b9019b5"],

Cell[TextData[{
 "Author: Leo C. Stein (",
 ButtonBox["leo.stein@gmail.com",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["mailto:leo.stein@gmail.com"], None},
  ButtonNote->"mailto:leo.stein@gmail.com"],
 ")\nDate: May 2015, updated November 2015, updated August 2016\nThis \
notebook is based on num-sep-of-vars.nb, which I wrote for Phys. Rev. D 90, \
044061 (2014) [",
 ButtonBox["arXiv:1407.2350",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://arxiv.org/abs/1407.2350"], None},
  ButtonNote->"http://arxiv.org/abs/1407.2350"],
 "].\nPlease DO NOT DISTRIBUTE this notebook without my express permission."
}], "Text",
 CellChangeTimes->{
  3.742735848525407*^9},ExpressionUUID->"1ab8fb8d-ed50-4d02-a64b-\
d38080f436d6"],

Cell[CellGroupData[{

Cell["Angular spectral method stuff\[AliasDelimiter]\[AliasDelimiter]\
\[AliasDelimiter]\[AliasDelimiter]\[AliasDelimiter]\[AliasDelimiter]\
\[AliasDelimiter]\[AliasDelimiter]\[AliasDelimiter]\[AliasDelimiter]\
\[AliasDelimiter]\[AliasDelimiter]\[AliasDelimiter]\[AliasDelimiter]\
\[AliasDelimiter]\[AliasDelimiter]\[AliasDelimiter]\[AliasDelimiter]\
\[AliasDelimiter]\[AliasDelimiter]\[AliasDelimiter]\[AliasDelimiter]", \
"Subsection",
 CellChangeTimes->{{3.743546805402677*^9, 
  3.743546806332053*^9}},ExpressionUUID->"a38df06e-8206-4a2a-a8c7-\
e6473efcac84"],

Cell["\<\
See Boyd, (F.52) for the Gauss-Lobatto roots of Legendre polynomials\
\>", "Text",ExpressionUUID->"1fc6ce5e-6674-4d78-ba7c-80aba161943f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LGLx", "[", "n_", "]"}], "[", "0", "]"}], ":=", 
  RowBox[{"-", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LGLx", "[", "n_", "]"}], "[", "n_", "]"}], ":=", 
  "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LGLx", "[", "n_", "]"}], "[", "j_", "]"}], ":=", 
  RowBox[{"Root", "[", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"x", ",", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"LegendreP", "[", 
         RowBox[{"n", ",", "x"}], "]"}], ",", "x"}], "]"}]}], "]"}], ",", 
    "j"}], "]"}]}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"566623aa-73a4-431b-8f19-edeb8142e25f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LGLxs", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"LGLxs", "[", "n", "]"}], "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"LGLx", "[", "n", "]"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "n"}], "]"}]}], "]"}]}]}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"786fbffb-3019-4619-b588-f9cb7c648b5c"],

Cell["\<\
See Boyd (F.53) for the Cardinal functions of Legendre Gauss-Lobatto and \
(F.54) for the quadrature weights\
\>", "Text",ExpressionUUID->"d1bb298b-0151-4f5e-a671-434524a634b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LGLC", "[", "n_", "]"}], "[", 
   RowBox[{"j_", ",", "x_"}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}], ")"}]}], 
    RowBox[{"n", 
     RowBox[{"(", 
      RowBox[{"n", "+", "1"}], ")"}], 
     RowBox[{"LegendreP", "[", 
      RowBox[{"n", ",", 
       RowBox[{
        RowBox[{"LGLx", "[", "n", "]"}], "[", "j", "]"}]}], "]"}], 
     RowBox[{"(", 
      RowBox[{"x", "-", 
       RowBox[{
        RowBox[{"LGLx", "[", "n", "]"}], "[", "j", "]"}]}], ")"}]}]], 
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "[", "LegendreP", "]"}], "[", 
    RowBox[{"n", ",", "x"}], "]"}]}]}]], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"8fab5ce8-726e-4976-9cc0-9b951f8eb1ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LGLInterpVec", "[", 
   RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"LGLC", "[", "n", "]"}], "[", 
     RowBox[{"i", ",", "x"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"13544563-6a81-412c-8586-f2a3a9ae7bbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LGLInterp", "[", "u_List", "]"}], "[", "x_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{
       RowBox[{"Length", "[", "u", "]"}], "-", "1"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"LGLInterpVec", "[", 
      RowBox[{"n", ",", "x"}], "]"}], ".", "u"}]}], "]"}]}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"cfe7069f-ced2-48b9-96e0-d398dbbdc53b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LGLw", "[", 
   RowBox[{"n_", ",", "j_"}], "]"}], ":=", 
  FractionBox["2", 
   RowBox[{"n", 
    RowBox[{"(", 
     RowBox[{"n", "+", "1"}], ")"}], 
    SuperscriptBox[
     RowBox[{"LegendreP", "[", 
      RowBox[{"n", ",", 
       RowBox[{
        RowBox[{"LGLxs", "[", "n", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], "2"]}]]}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"84b91167-fbed-4e11-a37c-2fbdce2bd277"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LGLInner", "[", "n_", "]"}], "[", 
    RowBox[{"f_List", ",", "g_List"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "f", "]"}], "\[Equal]", 
     RowBox[{"(", 
      RowBox[{"n", "+", "1"}], ")"}]}], "&&", 
    RowBox[{
     RowBox[{"Length", "[", "f", "]"}], "\[Equal]", 
     RowBox[{"Length", "[", "g", "]"}]}]}]}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"LGLw", "[", 
      RowBox[{"n", ",", "j"}], "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"[", 
       RowBox[{"j", "+", "1"}], "]"}], "]"}], 
     RowBox[{"g", "[", 
      RowBox[{"[", 
       RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"75b9313f-37e2-4d73-8d46-4cd7ac36fff2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LGLInner", "[", 
    RowBox[{"f_List", ",", "g_List"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "f", "]"}], "\[Equal]", 
    RowBox[{"Length", "[", "g", "]"}]}]}], ":=", 
  RowBox[{
   RowBox[{"LGLInner", "[", 
    RowBox[{
     RowBox[{"Length", "[", "f", "]"}], "-", "1"}], "]"}], "[", 
   RowBox[{"f", ",", "g"}], "]"}]}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"3688f174-378a-4742-ba9d-96b5f0683f32"],

Cell["See Boyd (5.37) for the definition of the transform matrix.", \
"Text",ExpressionUUID->"56a2a12c-e9a6-43e5-969d-6945016c157a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LGLMInv", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"LGLMInv", "[", "n", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"LegendreP", "[", 
      RowBox[{"j", ",", 
       RowBox[{
        RowBox[{"LGLxs", "[", "n", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}]], "Input",
 CellLabel->"In[11]:=",ExpressionUUID->"fd3188b0-5277-411d-99fe-81aaa66bd3ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LGLM", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"LGLM", "[", "n", "]"}], "=", 
   RowBox[{"Inverse", "@", 
    RowBox[{"LGLMInv", "[", "n", "]"}]}]}]}]], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"85617ec8-9674-4fee-932e-7e19122db1ef"],

Cell[TextData[{
 "The differentiation matrix (in collocation basis), from (F.55). ",
 StyleBox["NOTE",
  FontColor->RGBColor[1, 0, 0]],
 ": there is an erratum concerning the first two entries of Boyd\
\[CloseCurlyQuote]s Eq. (F.55). Verify this."
}], "Text",ExpressionUUID->"f6460461-3267-4d06-bfaa-9894488b3d26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LGLD", "[", "n_", "]"}], "[", 
   RowBox[{"0", ",", "0"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "/", "4"}], " ", "n", " ", 
   RowBox[{"(", 
    RowBox[{"n", "+", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LGLD", "[", "n_", "]"}], "[", 
   RowBox[{"n_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"1", "/", "4"}], " ", "n", " ", 
   RowBox[{"(", 
    RowBox[{"n", "+", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LGLD", "[", "n_", "]"}], "[", 
   RowBox[{"i_", ",", "i_"}], "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LGLD", "[", "n_", "]"}], "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", "=", 
      RowBox[{"LGLxs", "[", "n", "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"LegendreP", "[", 
      RowBox[{"n", ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"LegendreP", "[", 
        RowBox[{"n", ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", 
           RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
         RowBox[{"x", "[", 
          RowBox[{"[", 
           RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ")"}]}], ")"}]}]}], 
   "]"}]}]}], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"104579d5-462a-43ab-99dd-708a471bd271"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LGLDM", "[", "n_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"LGLDM", "[", "n", "]"}], "=", 
    RowBox[{"N", "@", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{"LGLD", "[", "n", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ",", 
         RowBox[{"n", "+", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}], ")"}]}]], "Input",
 CellLabel->
  "In[17]:=",ExpressionUUID->"4e3fabce-3e9c-4613-b2d3-fff0dc5b0592"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Radial spectral stuff", \
"Subsection",ExpressionUUID->"d581dc35-17fb-4476-af31-067fdf5b7b19"],

Cell["\<\
We use the Chebyshev collocation basis on the interior of the domain (-1,1). \
See Boyd (F.47), (F.50), etc.\
\>", "Text",ExpressionUUID->"f5bcd882-db67-4fd2-a43c-86396c857975"],

Cell["Collocation points:", \
"Text",ExpressionUUID->"aa8ab274-3834-43cd-afdf-8d52136fd737"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CIx", "[", "n_", "]"}], "[", "j_", "]"}], ":=", 
  RowBox[{"Cos", "[", 
   RowBox[{"\[Pi]", " ", 
    FractionBox[
     RowBox[{
      RowBox[{"2", "j"}], "-", "1"}], 
     RowBox[{"2", "n"}]]}], "]"}]}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"7a0a2ae0-e9a8-496f-84b1-87ad4362fddf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CIxs", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"CIxs", "[", "n", "]"}], "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"CIx", "[", "n", "]"}], "/@", 
     RowBox[{"Range", "[", "n", "]"}]}], "]"}]}]}]], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"b1167bda-95f0-48ba-b97a-7050467f09eb"],

Cell[TextData[{
 "Inner product. The weights are ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], "=", 
    FractionBox["\[Pi]", "n"]}], TraditionalForm]],ExpressionUUID->
  "351b969a-61b1-4140-8a9b-a48659cda814"],
 "."
}], "Text",ExpressionUUID->"d259fb8e-017b-4528-951b-988eb2d45f27"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CIInner", "[", "n_", "]"}], "[", 
    RowBox[{"f_List", ",", "g_List"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "f", "]"}], "\[Equal]", "n"}], "&&", 
    RowBox[{
     RowBox[{"Length", "[", "f", "]"}], "\[Equal]", 
     RowBox[{"Length", "[", "g", "]"}]}]}]}], ":=", 
  RowBox[{
   FractionBox["\[Pi]", "n"], 
   RowBox[{"f", ".", "g"}]}]}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"2e11833d-6d6a-4e6d-a5db-ea1d4e07a7bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CIInner", "[", 
    RowBox[{"f_List", ",", "g_List"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "f", "]"}], "\[Equal]", 
    RowBox[{"Length", "[", "g", "]"}]}]}], ":=", 
  RowBox[{
   RowBox[{"CIInner", "[", 
    RowBox[{"Length", "@", "f"}], "]"}], "[", 
   RowBox[{"f", ",", "g"}], "]"}]}]], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"39540f7e-462e-4c31-adb8-7d890e0ae4b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CIL2Norm", "[", "f_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"CIInner", "[", 
    RowBox[{"Length", "@", "f"}], "]"}], "[", 
   RowBox[{"f", ",", "f"}], "]"}]}]], "Input",
 CellLabel->"In[22]:=",ExpressionUUID->"79d1117f-1a5d-429e-9017-80f2968e8630"],

Cell["The transform matrix.", \
"Text",ExpressionUUID->"adde2540-26f0-4bd0-8f61-e304557a88b5"],

Cell[TextData[{
 "The weights are ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], "=", 
    FractionBox["\[Pi]", "n"]}], TraditionalForm]],ExpressionUUID->
  "c190417d-5e44-462d-9b0b-0ce09f9721ef"],
 ". The inner products of basis elements are ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Phi]", "i"], ",", 
      SubscriptBox["\[Phi]", "j"]}], ")"}], "=", 
    RowBox[{"{", GridBox[{
       {"0", 
        RowBox[{"i", "\[NotEqual]", "j"}]},
       {"\[Pi]", 
        RowBox[{"i", "=", 
         RowBox[{"j", "=", "0"}]}]},
       {
        RowBox[{"\[Pi]", "/", "2"}], 
        RowBox[{"i", "=", 
         RowBox[{"j", "\[NotEqual]", "0"}]}]}
      }]}]}], TraditionalForm]],ExpressionUUID->
  "3a3b6b5f-4427-4279-95d5-d0a56c5fee2a"],
 ".\nThe matrix elements of the transform matrix are given in Boyd (5.37) as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", "ij"], "=", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "i"], "(", 
       SubscriptBox["x", "j"], ")"}], 
      SubscriptBox["w", "j"]}], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Phi]", "i"], ",", 
       SubscriptBox["\[Phi]", "i"]}], ")"}]]}], TraditionalForm]],
  ExpressionUUID->"8f2ecec9-f17f-4f3b-8db9-7ffb8e1ab6d8"],
 "."
}], "Text",ExpressionUUID->"afb87372-3b62-4ffd-a3d3-b29770f38183"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CIM", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"CIM", "[", "n", "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Phi]\[Phi]", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "\[Pi]", "}"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           FractionBox["\[Pi]", "2"], ",", 
           RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["\[Pi]", "n"], 
      RowBox[{"Table", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"ChebyshevT", "[", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"CIxs", "[", "n", "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], 
         RowBox[{"\[Phi]\[Phi]", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
    "]"}]}]}]], "Input",
 CellLabel->"In[23]:=",ExpressionUUID->"98d5318f-6aea-4854-b32d-bd551cec7822"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CIMInv", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"CIMInv", "[", "n", "]"}], "=", 
   RowBox[{"Inverse", "@", 
    RowBox[{"CIM", "[", "n", "]"}]}]}]}]], "Input",
 CellLabel->"In[24]:=",ExpressionUUID->"da22b920-2f7d-47e7-a202-6b2d2d9d9e75"],

Cell["Differentiation matrix:", \
"Text",ExpressionUUID->"3d75cc7d-0b44-4ff3-bc82-e840da1f1977"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CID", "[", "n_", "]"}], "[", 
   RowBox[{"i_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], 
   FractionBox[
    RowBox[{
     RowBox[{"CIxs", "[", "n", "]"}], "[", 
     RowBox[{"[", "i", "]"}], "]"}], 
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{
       RowBox[{"CIxs", "[", "n", "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "2"]}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CID", "[", "n_", "]"}], "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], 
    RowBox[{"i", "+", "j"}]], 
   FractionBox[
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"CIxs", "[", "n", "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "2"]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"CIxs", "[", "n", "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "2"]}], ")"}]}], "]"}], 
    RowBox[{
     RowBox[{
      RowBox[{"CIxs", "[", "n", "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], "-", 
     RowBox[{
      RowBox[{"CIxs", "[", "n", "]"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}]}]]}]}]}], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"a30b1f36-9e42-4b90-a7f1-071dc0239645"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CIDM", "[", "n_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"CIDM", "[", "n", "]"}], "=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{"CID", "[", "n", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ")"}]}]], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"425dc2a4-301c-4818-8369-14a766258e0e"],

Cell["Cardinal (interpolation) functions:", \
"Text",ExpressionUUID->"24771322-1306-4d9a-9562-bd5d1b4e86fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CIC", "[", "n_", "]"}], "[", 
   RowBox[{"j_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"ArcCos", "[", "x", "]"}]}], ",", 
      RowBox[{"tj", "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"CIxs", "[", "n", "]"}], "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"n", " ", "t"}], "]"}], 
      RowBox[{"Sin", "[", "tj", "]"}]}], 
     RowBox[{"n", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"n", " ", "tj"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", "t", "]"}], "-", 
        RowBox[{"Cos", "[", "tj", "]"}]}], ")"}]}]]}], "]"}]}]], "Input",
 Evaluatable->False,ExpressionUUID->"329bb62a-d4c2-4a17-9199-48722417119e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CIC", "[", "n_", "]"}], "[", 
   RowBox[{"j_", ",", "x_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"ChebyshevT", "[", 
    RowBox[{"n", ",", "x"}], "]"}], 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"0", ",", "1"}], "]"}], "[", "ChebyshevT", "]"}], "[", 
     RowBox[{"n", ",", 
      RowBox[{
       RowBox[{"CIxs", "[", "n", "]"}], "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], 
    RowBox[{"(", 
     RowBox[{"x", "-", 
      RowBox[{
       RowBox[{"CIxs", "[", "n", "]"}], "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}]]}]], "Input",
 CellLabel->"In[28]:=",ExpressionUUID->"da03ef99-0161-4b44-aa6d-91ecdfaf9272"],

Cell["\<\
Put together the interpolating function from some collocation points\
\>", "Text",ExpressionUUID->"7154fc07-9a15-4533-a004-4beb20c5a2ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CIInterpVec", "[", 
   RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CIC", "[", "n", "]"}], "[", 
     RowBox[{"i", ",", "x"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"664d1df3-cb64-4380-906d-c1d691392eb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CIInterp", "[", "u_List", "]"}], "[", "x_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "u", "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"CIInterpVec", "[", 
      RowBox[{"n", ",", "x"}], "]"}], ".", "u"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[30]:=",ExpressionUUID->"1b5033ff-21ec-44a4-a51c-3621455e544e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The radial differential operators we care about solving", \
"Subsection",ExpressionUUID->"208cb901-740a-462c-a180-6371e086e029"],

Cell["See my notes where I go through the r\[Rule]\[Eta]\[Rule]x \
transformation", \
"Text",ExpressionUUID->"0a87bd12-bdd5-4d3d-af92-9f2e780b984f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RDiffOp", "[", "n_", "]"}], "[", "l_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"RDiffOp", "[", "n", "]"}], "[", "l", "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xs", "=", 
        RowBox[{"CIxs", "[", "n", "]"}]}], ",", 
       RowBox[{"D1", "=", 
        RowBox[{"N", "@", 
         RowBox[{"CIDM", "[", "n", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"xs", "-", "1"}], ")"}], "2"], "]"}], ".", "D1", ".", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "xs"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"3", "-", "xs"}], ")"}]}], "]"}], ".", "D1"}]}], "-", 
      RowBox[{"l", 
       RowBox[{"(", 
        RowBox[{"l", "+", "1"}], ")"}], 
       RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}]}], "]"}]}]}]], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"758c43d8-ccbe-4593-a8b4-2874d5b51c8b"],

Cell[TextData[{
 "These all have full rank ",
 StyleBox["except",
  FontSlant->"Italic"],
 " for the \[ScriptL]=0 one. Interesting!"
}], "Text",ExpressionUUID->"af710675-56d2-46e6-8bab-e6edc73d705d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"NullSpace", "[", 
  RowBox[{
   RowBox[{"RDiffOp", "[", "7", "]"}], "[", "0", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RDiffOp", "[", "7", "]"}], "[", "0", "]"}], "=."}]}], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"17c4ea0b-3b0b-4eb0-92ef-85100162dc9d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
   "0.37796447300922814`", ",", "0.37796447300922725`", ",", 
    "0.37796447300922675`", ",", "0.377964473009227`", ",", 
    "0.377964473009227`", ",", "0.3779644730092272`", ",", 
    "0.37796447300922714`"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.742324444392722*^9, 3.7423247276196747`*^9, 
  3.742324935937791*^9, 3.742325806012518*^9, 3.7423269820199223`*^9, 
  3.742330236360614*^9, 3.7425699269708843`*^9, 3.742577753342597*^9, 
  3.742651715835725*^9, 3.74266571435233*^9, 3.742679483614624*^9, 
  3.7427311235387497`*^9, 3.7427337004040937`*^9, 3.742736246547855*^9, 
  3.742759244617545*^9, 3.742759938713375*^9, 3.7428202320371323`*^9, 
  3.742838625313451*^9, 3.743537956082397*^9, 3.743538309295536*^9, 
  3.74354146370702*^9, 3.743544012341915*^9, 3.746188168230983*^9, 
  3.746188378861164*^9, 3.746188556080326*^9, 3.746206619657387*^9, 
  3.746228546616708*^9, 3.746228694940299*^9, 3.746229225539847*^9, 
  3.746229940263494*^9, 3.777042516088895*^9, 3.7771265000714893`*^9, 
  3.777131079456766*^9, 3.7771311470419807`*^9},
 CellLabel->
  "Out[32]=",ExpressionUUID->"2601e294-a801-4a13-83ef-5c21f2d60ffd"]
}, Open  ]],

Cell["\<\
This means I need special handling for the \[ScriptL]=0 case.
Notice that the null space is just (1,1,...,1), so all rows of the matrix are \
involved in the linear combination to kill an individual row. Therefore I can \
overwrite any given row with my boundary condition.
The boundary condition is that the solution vanishes at r\[Rule]\[Infinity]. \
This is x\[Rule]1, and because of the ordering of the CIxs, we will use the \
first row.
We will overwrite the first row with (1,0,0,...,0). At the same time, in the \
\[OpenCurlyDoubleQuote]solver\[CloseCurlyDoubleQuote] stage, when we get a \
LHS to the equation RDiffOp.x=b, we must replace the first element of b with \
zero.\
\>", "Text",ExpressionUUID->"21ce1527-f342-4e4c-84d8-6e79e1b127e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RDiffOp", "[", "n_", "]"}], "[", "0", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"RDiffOp", "[", "n", "]"}], "[", "0", "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xs", "=", 
        RowBox[{"CIxs", "[", "n", "]"}]}], ",", 
       RowBox[{"D1", "=", 
        RowBox[{"N", "@", 
         RowBox[{"CIDM", "[", "n", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"origOp", "=", 
          RowBox[{
           FractionBox["1", "4"], 
           RowBox[{
            RowBox[{"DiagonalMatrix", "[", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"xs", "-", "1"}], ")"}], "2"], "]"}], ".", "D1", ".", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", "xs"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"3", "-", "xs"}], ")"}]}], "]"}], ".", "D1"}]}]}], ",", 
         RowBox[{"newFirstRow", "=", 
          RowBox[{
           RowBox[{"{", "1", "}"}], "~", "Join", "~", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "newFirstRow", "}"}], "~", "Join", "~", 
        RowBox[{"origOp", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellLabel->"In[34]:=",ExpressionUUID->"f3750613-5068-45c9-9f01-799063d78008"],

Cell["This can be saved:", \
"Text",ExpressionUUID->"77a426e3-09e1-47d3-84f7-23ced472ca1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RDiffSolver", "[", "n_", "]"}], "[", "l_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"RDiffSolver", "[", "n", "]"}], "[", "l", "]"}], "=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{
     RowBox[{"RDiffOp", "[", "n", "]"}], "[", "l", "]"}], "]"}]}]}]], "Input",
 
 CellLabel->"In[35]:=",ExpressionUUID->"ac83cc31-e303-412d-8fe5-9ae532e7b75d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RDiffSolve", "[", "n_", "]"}], "[", "0", "]"}], "[", "b_", "]"}],
   ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newb", "=", 
      RowBox[{
       RowBox[{"{", "0", "}"}], "~", "Join", "~", 
       RowBox[{"b", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"RDiffSolver", "[", "n", "]"}], "[", "0", "]"}], "[", "b", 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RDiffSolve", "[", "n_", "]"}], "[", "l_", "]"}], "[", "b_", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"RDiffSolver", "[", "n", "]"}], "[", "l", "]"}], "[", "b", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[36]:=",ExpressionUUID->"72c4de12-2f99-4f93-9050-a80489f2ca80"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Source stuff", \
"Subsection",ExpressionUUID->"e04598b3-2ea0-46dd-a519-9ab7ddc13372"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalSigma]", "[", 
   RowBox[{"c_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["r", "2"], "+", 
   RowBox[{
    SuperscriptBox["a", "2"], 
    SuperscriptBox["c", "2"]}]}]}]], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"2aa0e0d7-a29d-4656-852f-1c7f0415eb14"],

Cell["\<\
NOTE: This source below differs in convention from my previous paper!\
\>", "Text",ExpressionUUID->"3473f0e1-258a-4b1a-9b79-2a1ef46d2588"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sourceCS", "[", 
   RowBox[{"c_", ",", "r_"}], "]"}], ":=", 
  RowBox[{"24", 
   FractionBox[
    RowBox[{"a", " ", "c", " ", "r", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", 
        SuperscriptBox["r", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["a", "2"], 
        SuperscriptBox["c", "2"]}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "-", 
       RowBox[{"3", 
        SuperscriptBox["a", "2"], 
        SuperscriptBox["c", "2"]}]}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"\[CapitalSigma]", "[", 
      RowBox[{"c", ",", "r"}], "]"}], "5"]]}]}]], "Input",
 CellLabel->"In[39]:=",ExpressionUUID->"d678ae62-2de0-4852-962a-fe6765813e90"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sourceCS", "[", 
   RowBox[{"c", ",", "r"}], "]"}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"24", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"3", " ", "a", " ", "r", " ", "c"}], 
       SuperscriptBox[
        RowBox[{"\[CapitalSigma]", "[", 
         RowBox[{"c", ",", "r"}], "]"}], "3"]], "-", 
      FractionBox[
       RowBox[{"16", " ", 
        SuperscriptBox["a", "3"], 
        SuperscriptBox["r", "3"], 
        SuperscriptBox["c", "3"]}], 
       SuperscriptBox[
        RowBox[{"\[CapitalSigma]", "[", 
         RowBox[{"c", ",", "r"}], "]"}], "5"]]}], ")"}]}], "//", "Together"}],
   "//", "Factor"}]}], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"557cb9a9-9057-468a-a120-88de0e2066c8"],

Cell[BoxData[
 FractionBox[
  RowBox[{"24", " ", "a", " ", "c", " ", "r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["c", "2"]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["r", "2"]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["c", "2"]}], "-", 
     SuperscriptBox["r", "2"]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["c", "2"]}], "+", 
     SuperscriptBox["r", "2"]}], ")"}], "5"]]], "Output",
 CellChangeTimes->{3.7423244444857883`*^9, 3.7423247277211847`*^9, 
  3.742324936042417*^9, 3.742325806143736*^9, 3.742326982119982*^9, 
  3.742330236464087*^9, 3.742569927163124*^9, 3.742577753431755*^9, 
  3.742651715942691*^9, 3.742665714477057*^9, 3.74267948373492*^9, 
  3.7427311236797523`*^9, 3.742733700482905*^9, 3.742736246633525*^9, 
  3.742759244724205*^9, 3.7427599387930727`*^9, 3.742820232147048*^9, 
  3.742838625613389*^9, 3.743537956188017*^9, 3.7435383093717318`*^9, 
  3.743541463790351*^9, 3.743544012475202*^9, 3.746188168357626*^9, 
  3.746188378955779*^9, 3.746188556256042*^9, 3.746206619755987*^9, 
  3.74622854672361*^9, 3.7462286950514297`*^9, 3.746229225683957*^9, 
  3.746229940415246*^9, 3.777042516149494*^9, 3.777126500195513*^9, 
  3.777131079531855*^9, 3.777131147157045*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"e675364c-cdea-4850-91e8-14bb963de5e6"],

Cell[BoxData[
 FractionBox[
  RowBox[{"24", " ", "a", " ", "c", " ", "r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["c", "2"]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["r", "2"]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["c", "2"]}], "-", 
     SuperscriptBox["r", "2"]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["c", "2"]}], "+", 
     SuperscriptBox["r", "2"]}], ")"}], "5"]]], "Output",
 CellChangeTimes->{3.7423244444857883`*^9, 3.7423247277211847`*^9, 
  3.742324936042417*^9, 3.742325806143736*^9, 3.742326982119982*^9, 
  3.742330236464087*^9, 3.742569927163124*^9, 3.742577753431755*^9, 
  3.742651715942691*^9, 3.742665714477057*^9, 3.74267948373492*^9, 
  3.7427311236797523`*^9, 3.742733700482905*^9, 3.742736246633525*^9, 
  3.742759244724205*^9, 3.7427599387930727`*^9, 3.742820232147048*^9, 
  3.742838625613389*^9, 3.743537956188017*^9, 3.7435383093717318`*^9, 
  3.743541463790351*^9, 3.743544012475202*^9, 3.746188168357626*^9, 
  3.746188378955779*^9, 3.746188556256042*^9, 3.746206619755987*^9, 
  3.74622854672361*^9, 3.7462286950514297`*^9, 3.746229225683957*^9, 
  3.746229940415246*^9, 3.777042516149494*^9, 3.777126500195513*^9, 
  3.777131079531855*^9, 3.777131147167018*^9},
 CellLabel->
  "Out[41]=",ExpressionUUID->"971426e7-d0a2-43f8-aabe-75521617b299"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sourceCS", "[", 
   RowBox[{"c_", ",", "r_"}], "]"}], ":=", 
  RowBox[{"24", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", "a", " ", "r", " ", "c"}], 
      SuperscriptBox[
       RowBox[{"\[CapitalSigma]", "[", 
        RowBox[{"c", ",", "r"}], "]"}], "3"]], "-", 
     FractionBox[
      RowBox[{"16", " ", 
       SuperscriptBox["a", "3"], 
       SuperscriptBox["r", "3"], 
       SuperscriptBox["c", "3"]}], 
      SuperscriptBox[
       RowBox[{"\[CapitalSigma]", "[", 
        RowBox[{"c", ",", "r"}], "]"}], "5"]]}], ")"}]}]}]], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"217ebc2d-7151-4965-9ef3-dee08f7ccd9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sourceGB", "[", 
   RowBox[{"c_", ",", "r_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"48", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        InterpretationBox[
         StyleBox["a",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`a,
         Editable->False]}], " ", "c"}], "+", "r"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox["a",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`a,
        Editable->False], " ", "c"}], "+", "r"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        InterpretationBox[
         StyleBox["a",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`a,
         Editable->False], "2"], " ", 
       SuperscriptBox["c", "2"]}], "-", 
      RowBox[{"4", " ", 
       InterpretationBox[
        StyleBox["a",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`a,
        Editable->False], " ", "c", " ", "r"}], "+", 
      SuperscriptBox["r", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        InterpretationBox[
         StyleBox["a",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`a,
         Editable->False], "2"], " ", 
       SuperscriptBox["c", "2"]}], "+", 
      RowBox[{"4", " ", 
       InterpretationBox[
        StyleBox["a",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`a,
        Editable->False], " ", "c", " ", "r"}], "+", 
      SuperscriptBox["r", "2"]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"\[CapitalSigma]", "[", 
     RowBox[{"c", ",", "r"}], "]"}], "6"]]}]], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"199026c9-36ba-4bb1-b2c6-a619cadf87a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Eta]ofr", "[", "r_", "]"}], ":=", 
  FractionBox[
   RowBox[{"r", "-", "1"}], "b"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rof\[Eta]", "[", "\[Eta]_", "]"}], ":=", 
  RowBox[{"1", "+", 
   RowBox[{"b", " ", "\[Eta]"}]}]}]}], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"a2009c91-27cd-42fb-b9c9-8a03b4f9a8da"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Together", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"sourceCS", "[", 
      RowBox[{"c", ",", "r"}], "]"}], "/.", 
     RowBox[{"r", "\[Rule]", 
      RowBox[{"rof\[Eta]", "[", "\[Eta]", "]"}]}]}], "/.", 
    RowBox[{"\[Eta]", "\[Rule]", 
     FractionBox["2", 
      RowBox[{"1", "-", "x"}]]}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sourceCSinx", "[", 
   RowBox[{"c_", ",", "x_"}], "]"}], "=", "%"}]}], "Input",
 CellLabel->"In[46]:=",ExpressionUUID->"82dbc35b-593a-4897-9744-daa611257e30"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"24", " ", "a", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"48", " ", 
         SuperscriptBox["b", "4"]}], "-", 
        RowBox[{"96", " ", 
         SuperscriptBox["b", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "-", 
        RowBox[{"8", " ", 
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "9"}], "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["c", "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]}], "+", 
        RowBox[{"8", " ", "b", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["c", "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], "3"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"10", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["c", "2"]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["a", "4"], " ", 
            SuperscriptBox["c", "4"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], "4"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "b"}], "-", "x"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], ")"}], "5"]}], ")"}], "/", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["b", "2"]}], "-", 
       RowBox[{"4", " ", "b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["c", "2"]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]}]}], ")"}], "5"]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.7423244446603327`*^9, 3.742324727821323*^9, 
  3.74232493614823*^9, 3.742325806276266*^9, 3.742326982244319*^9, 
  3.7423302365773697`*^9, 3.742569927273837*^9, 3.74257775355412*^9, 
  3.7426517160913687`*^9, 3.74266571461685*^9, 3.742679483860461*^9, 
  3.7427311237941523`*^9, 3.742733700599786*^9, 3.742736246731492*^9, 
  3.742759244841894*^9, 3.7427599389050198`*^9, 3.7428202322731047`*^9, 
  3.742838625781701*^9, 3.743537956361251*^9, 3.743538309483391*^9, 
  3.743541463909731*^9, 3.74354401258747*^9, 3.7461881685140257`*^9, 
  3.746188379098708*^9, 3.7461885563935823`*^9, 3.74620661987389*^9, 
  3.746228546850216*^9, 3.74622869518333*^9, 3.746229225827187*^9, 
  3.746229940546726*^9, 3.777042516244729*^9, 3.777126500321327*^9, 
  3.777131079613617*^9, 3.777131147383276*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"d9344c99-275a-41e3-bdd6-c96505764338"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"24", " ", "a", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"48", " ", 
         SuperscriptBox["b", "4"]}], "-", 
        RowBox[{"96", " ", 
         SuperscriptBox["b", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "-", 
        RowBox[{"8", " ", 
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "9"}], "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["c", "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]}], "+", 
        RowBox[{"8", " ", "b", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["c", "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], "3"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"10", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["c", "2"]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["a", "4"], " ", 
            SuperscriptBox["c", "4"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], "4"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "b"}], "-", "x"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], ")"}], "5"]}], ")"}], "/", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["b", "2"]}], "-", 
       RowBox[{"4", " ", "b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["c", "2"]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]}]}], ")"}], "5"]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.7423244446603327`*^9, 3.742324727821323*^9, 
  3.74232493614823*^9, 3.742325806276266*^9, 3.742326982244319*^9, 
  3.7423302365773697`*^9, 3.742569927273837*^9, 3.74257775355412*^9, 
  3.7426517160913687`*^9, 3.74266571461685*^9, 3.742679483860461*^9, 
  3.7427311237941523`*^9, 3.742733700599786*^9, 3.742736246731492*^9, 
  3.742759244841894*^9, 3.7427599389050198`*^9, 3.7428202322731047`*^9, 
  3.742838625781701*^9, 3.743537956361251*^9, 3.743538309483391*^9, 
  3.743541463909731*^9, 3.74354401258747*^9, 3.7461881685140257`*^9, 
  3.746188379098708*^9, 3.7461885563935823`*^9, 3.74620661987389*^9, 
  3.746228546850216*^9, 3.74622869518333*^9, 3.746229225827187*^9, 
  3.746229940546726*^9, 3.777042516244729*^9, 3.777126500321327*^9, 
  3.777131079613617*^9, 3.777131147394437*^9},
 CellLabel->
  "Out[47]=",ExpressionUUID->"49d4f7a2-a054-4cdb-afc6-6bd958dd514b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sampleSourceCS", "[", 
   RowBox[{"Nang_", ",", "Nx_", ",", "A_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"gridc", "=", 
       RowBox[{"LGLxs", "[", 
        RowBox[{"Nang", "-", "1"}], "]"}]}], ",", 
      RowBox[{"gridx", "=", 
       RowBox[{"CIxs", "[", "Nx", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"sourceCSinx", "[", 
          RowBox[{
           RowBox[{"gridc", "[", 
            RowBox[{"[", "#1", "]"}], "]"}], ",", 
           RowBox[{"gridx", "[", 
            RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "/.", 
         RowBox[{"b", "\[Rule]", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "-", 
            SuperscriptBox["a", "2"]}], "]"}]}]}], "/.", 
        RowBox[{"a", "\[Rule]", "A"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"Nang", ",", "Nx"}], "}"}]}], "]"}]}], "]"}]}]], "Input",
 Evaluatable->False,
 CellChangeTimes->{
  3.77704939254137*^9},ExpressionUUID->"a5252974-e862-4462-80f1-4c8303426fc8"],

Cell["I like the following code, as it relies on less magic", \
"Text",ExpressionUUID->"3c7f7f4d-9f03-4a66-a518-34b47956eb9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sampleSourceCS", "[", 
   RowBox[{"Nang_", ",", "Nx_", ",", "a_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["a", "2"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"LGLxs", "[", 
           RowBox[{"Nang", "-", "1"}], "]"}], ",", "Nx"}], "]"}]}]}], ",", 
      RowBox[{"x", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"CIxs", "[", "Nx", "]"}], ",", "Nang"}], "]"}]}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", "=", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"2", "b"}], 
          RowBox[{"1", "-", "x"}]]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Sigma]", "=", 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], 
            SuperscriptBox["c", "2"]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"24", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"3", " ", "a", " ", "r", " ", "c"}], 
            SuperscriptBox["\[Sigma]", "3"]], "-", 
           FractionBox[
            RowBox[{"16", " ", 
             SuperscriptBox["a", "3"], 
             SuperscriptBox["r", "3"], 
             SuperscriptBox["c", "3"]}], 
            SuperscriptBox["\[Sigma]", "5"]]}], ")"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[48]:=",ExpressionUUID->"d14b05b1-7e5c-4959-8383-4c6dcf98ad84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sampleSourceGB", "[", 
   RowBox[{"Nang_", ",", "Nx_", ",", "a_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["a", "2"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"LGLxs", "[", 
           RowBox[{"Nang", "-", "1"}], "]"}], ",", "Nx"}], "]"}]}]}], ",", 
      RowBox[{"x", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"CIxs", "[", "Nx", "]"}], ",", "Nang"}], "]"}]}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", "=", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"2", "b"}], 
          RowBox[{"1", "-", "x"}]]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Sigma]", "=", 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], 
            SuperscriptBox["c", "2"]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        FractionBox[
         RowBox[{"48", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              InterpretationBox[
               StyleBox["a",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`a,
               Editable->False]}], " ", "c"}], "+", "r"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             InterpretationBox[
              StyleBox["a",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`a,
              Editable->False], " ", "c"}], "+", "r"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              InterpretationBox[
               StyleBox["a",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`a,
               Editable->False], "2"], " ", 
             SuperscriptBox["c", "2"]}], "-", 
            RowBox[{"4", " ", 
             InterpretationBox[
              StyleBox["a",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`a,
              Editable->False], " ", "c", " ", "r"}], "+", 
            SuperscriptBox["r", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              InterpretationBox[
               StyleBox["a",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`a,
               Editable->False], "2"], " ", 
             SuperscriptBox["c", "2"]}], "+", 
            RowBox[{"4", " ", 
             InterpretationBox[
              StyleBox["a",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`a,
              Editable->False], " ", "c", " ", "r"}], "+", 
            SuperscriptBox["r", "2"]}], ")"}]}], 
         SuperscriptBox["\[Sigma]", "6"]]}], "\[IndentingNewLine]", "]"}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[49]:=",ExpressionUUID->"f8066263-09de-44f4-b72a-47076b136d0d"],

Cell["Here is the Legendre transform of the sampled source", \
"Text",ExpressionUUID->"df59adf2-6c45-4c9d-8b02-bfff54f24770"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sampleSourceCSLeg", "[", 
   RowBox[{"Nang_", ",", "Nx_", ",", "a_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"LGLM", "[", 
    RowBox[{"Nang", "-", "1"}], "]"}], ".", 
   RowBox[{"sampleSourceCS", "[", 
    RowBox[{"Nang", ",", "Nx", ",", "a"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.742324661619321*^9, 3.742324662251062*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"8ea09be6-9dc9-4586-985d-21df5e4b6942"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sampleSourceGBLeg", "[", 
   RowBox[{"Nang_", ",", "Nx_", ",", "a_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"LGLM", "[", 
    RowBox[{"Nang", "-", "1"}], "]"}], ".", 
   RowBox[{"sampleSourceGB", "[", 
    RowBox[{"Nang", ",", "Nx", ",", "a"}], "]"}]}]}]], "Input",
 CellLabel->
  "In[51]:=",ExpressionUUID->"20713cad-0ced-4c8d-b298-4dee419eb63d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Try solving it a bit", \
"Subsection",ExpressionUUID->"cf779df7-62d5-4428-a10a-a044e5d6ee6e"],

Cell["Solve data that is given spectrally in the \[Theta] direction", \
"Text",ExpressionUUID->"b519ad02-7c14-4afc-843b-5ebf1b4ef183"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MySolveSpec", "[", "src_List", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Nang", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "src", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"Nx", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "src", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"RDiffSolve", "[", "Nx", "]"}], "[", "l", "]"}], "[", 
       RowBox[{"src", "[", 
        RowBox[{"[", 
         RowBox[{"l", "+", "1"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", 
        RowBox[{"Nang", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[52]:=",ExpressionUUID->"1ccbc7ed-5b58-43e5-bde9-2e0c8f047642"],

Cell["\<\
For data on the collocation grid. Involves transforming into the spectral \
domain, solving with the above, and then transforming back from the spectral \
domain.\
\>", "Text",ExpressionUUID->"365e2af2-52fa-4958-9b81-20f47ab75127"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MySolveCo", "[", "src_List", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Nang", "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", "src", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LGLMInv", "[", 
      RowBox[{"Nang", "-", "1"}], "]"}], ".", 
     RowBox[{"MySolveSpec", "[", 
      RowBox[{
       RowBox[{"LGLM", "[", 
        RowBox[{"Nang", "-", "1"}], "]"}], ".", "src"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"888635dd-a5c3-4d10-97df-27d0aa355308"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["MASHA PART", "Chapter"]], "Subsubsection",
 CellChangeTimes->{{3.74232624837176*^9, 
  3.74232624990658*^9}},ExpressionUUID->"072131d8-b75e-43da-b332-\
afb6c8bffbcd"],

Cell["\<\
Note that in this solution, X = r Sin(theta) and Z = r Cos(theta) \
\>", "Text",
 CellChangeTimes->{{3.7423261714972973`*^9, 
  3.7423261915737267`*^9}},ExpressionUUID->"e22b8528-4ba9-4cef-9d25-\
467eb87f565d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SpECFiles", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<0\>\"", ",", "\"\<1\>\"", ",", "\"\<2\>\"", ",", "\"\<3\>\"", ",", 
     "\"\<4\>\"", ",", "\"\<5\>\"", ",", "\"\<6\>\"", ",", "\"\<7\>\"", ",", 
     "\"\<8\>\"", ",", "\"\<9\>\"", ",", "\"\<10\>\"", ",", "\"\<11\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MySpins", " ", "=", " ", 
   RowBox[{"{", "0", "}"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "0.5", ",", " ", "0.52", ",", " ", "0.54", ",", " ", "0.56", ",", " ", 
      "0.58", ",", " ", "0.6", ",", " ", "0.62", ",", "0.64", ",", "0.66", 
      ",", "0.68", ",", " ", "0.7"}], "}"}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.7461882846951437`*^9, {3.746188643813146*^9, 3.746188660165793*^9}, {
   3.746198737718441*^9, 3.746198741689975*^9}, {3.746199421196908*^9, 
   3.746199422938191*^9}, {3.746200253320105*^9, 3.74620030142979*^9}, {
   3.7462006377031317`*^9, 3.746200640171137*^9}, {3.74620240252525*^9, 
   3.746202410956168*^9}, 3.746228416193466*^9, {3.746228646828856*^9, 
   3.746228657993288*^9}, {3.7462291581701317`*^9, 3.7462291762141657`*^9}, {
   3.777042424026849*^9, 3.777042448217949*^9}, {3.777042908305613*^9, 
   3.777042908506309*^9}, {3.7771264753814297`*^9, 3.777126479826194*^9}, {
   3.777131121459857*^9, 3.7771311255764923`*^9}, {3.777131328911672*^9, 
   3.7771313318791847`*^9}, {3.777133888364746*^9, 3.777133912830668*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"eb471f5d-d717-4e9d-a978-e3c9ce2a6162"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"jj", "=", "1"}], ",", " ", 
   RowBox[{"jj", "\[LessEqual]", 
    RowBox[{
     RowBox[{"Dimensions", "[", "MySpins", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
   RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MySpin", " ", ":=", " ", 
     RowBox[{"MySpins", "[", 
      RowBox[{"[", "jj", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "MySpin", "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]solsCSLeg", "[", 
      RowBox[{"16", ",", " ", "128", ",", "MySpin"}], "]"}], "=", 
     RowBox[{"MySolveSpec", "[", 
      RowBox[{"sampleSourceCSLeg", "[", 
       RowBox[{"16", ",", " ", "128", ",", "MySpin"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]solsGBLeg", "[", 
      RowBox[{"16", ",", " ", "128", ",", "MySpin"}], "]"}], ":=", 
     RowBox[{"MySolveSpec", "@", 
      RowBox[{"sampleSourceGBLeg", "[", 
       RowBox[{"16", ",", " ", "128", ",", "MySpin"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]solsCS", "[", 
      RowBox[{"16", ",", " ", "128", " ", ",", "MySpin"}], "]"}], "=", 
     RowBox[{
      RowBox[{"LGLMInv", "[", 
       RowBox[{"16", "-", "1"}], "]"}], ".", 
      RowBox[{"\[Theta]solsCSLeg", "[", 
       RowBox[{"16", ",", " ", "128", " ", ",", "MySpin"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]solsGB", "[", 
      RowBox[{"16", ",", " ", "128", " ", ",", "MySpin"}], "]"}], ":=", 
     RowBox[{"MySolveCo", "@", 
      RowBox[{"sampleSourceGB", "[", 
       RowBox[{"16", ",", " ", "128", " ", ",", "MySpin"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PolyInterp", "[", "data_List", "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Nang", "=", 
          RowBox[{
           RowBox[{"Dimensions", "[", "data", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"Nx", "=", 
          RowBox[{
           RowBox[{"Dimensions", "[", "data", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cs", "=", 
            RowBox[{"LGLxs", "[", 
             RowBox[{"Nang", "-", "1"}], "]"}]}], ",", 
           RowBox[{"xs", "=", 
            RowBox[{"CIxs", "[", "Nx", "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"cs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"xs", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "Nang"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "Nx"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
          "]"}]}], "]"}]}], "]"}]}], ";", "\n", 
    RowBox[{
     RowBox[{"\[Theta]solsCSInterp", "[", 
      RowBox[{"16", ",", " ", "128", " ", ",", "MySpin"}], "]"}], "=", 
     RowBox[{"PolyInterp", "[", 
      RowBox[{"\[Theta]solsCS", "[", 
       RowBox[{"16", ",", " ", "128", " ", ",", "MySpin"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]solsGBInterp", "[", 
      RowBox[{"16", ",", " ", "128", " ", ",", "MySpin"}], "]"}], "=", 
     RowBox[{"PolyInterp", "[", 
      RowBox[{"\[Theta]solsGB", "[", 
       RowBox[{"16", ",", " ", "128", " ", ",", "MySpin"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Change", " ", "the", " ", "below", " ", "CS", " ", "to", " ", "GB", 
       " ", "in", " ", "order", " ", "to", " ", "go", " ", "from", " ", 
       "Chern"}], "-", 
      RowBox[{"Simons", " ", "to", " ", "EDGB"}]}], " ", "*)"}], "\n", 
    RowBox[{
     RowBox[{"EvaluateLeoSolution", "[", 
      RowBox[{"xx_", ",", "zz_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]solsGBInterp", "[", 
       RowBox[{"16", ",", " ", "128", " ", ",", "MySpin"}], "]"}], "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["Z", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SuperscriptBox["X", "2"], "+", 
            SuperscriptBox["Z", "2"]}], "]"}]], "/.", 
         RowBox[{"Z", "\[Rule]", "zz"}]}], "/.", 
        RowBox[{"X", "\[Rule]", "xx"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"\[Eta]ofr", "[", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                SuperscriptBox["X", "2"], "+", 
                SuperscriptBox["Z", "2"]}], "]"}], "]"}], "-", "2"}], 
            RowBox[{"\[Eta]ofr", "[", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               SuperscriptBox["X", "2"], "+", 
               SuperscriptBox["Z", "2"]}], "]"}], "]"}]], "/.", 
           RowBox[{"b", "\[Rule]", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"1", "-", 
              SuperscriptBox["a", "2"]}], "]"}]}]}], "/.", 
          RowBox[{"a", "\[Rule]", "MySpin"}]}], "/.", 
         RowBox[{"Z", "\[Rule]", "zz"}]}], "/.", 
        RowBox[{"X", "\[Rule]", "xx"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "SpECFiles", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Read", " ", "in", " ", "the", " ", "data"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", "i", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SpECFile", " ", ":=", " ", 
        RowBox[{
        "\"\</Users/mokounkova/EDGB/InitialDataGeneration/Domains/Domain\>\"",
          "<>", 
         RowBox[{"ToString", "[", "MySpin", "]"}], "<>", 
         "\"\</Vars_Sphere\>\"", "<>", 
         RowBox[{"SpECFiles", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<.h5\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"KSX", " ", "=", "  ", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"SpECFile", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Datasets\>\"", ",", "\"\</X\>\""}], "}"}]}], "]"}], 
         "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"KSY", " ", "=", "  ", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"SpECFile", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Datasets\>\"", ",", "\"\</Y\>\""}], "}"}]}], "]"}], 
         "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"KSZ", " ", "=", " ", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"SpECFile", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Datasets\>\"", ",", "\"\</Z\>\""}], "}"}]}], "]"}], 
         "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Transform", " ", "to", " ", "Boyer"}], "-", 
         RowBox[{"Lindquist", " ", "coords"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BoyerLindquistr", "[", 
         RowBox[{"ksx_", ",", "ksy_", ",", "ksz_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ksx", "^", "2"}], "+", 
                RowBox[{"ksy", "^", "2"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MySpin", "^", "2"}], "+", 
                RowBox[{"r", "^", "2"}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"ksz", "^", "2"}], "/", 
              RowBox[{"r", "^", "2"}]}]}], "\[Equal]", "1"}], ",", "r"}], 
          "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", 
       RowBox[{"BLR", " ", "=", " ", 
        RowBox[{
         RowBox[{"Abs", "[", "r", "]"}], "/.", 
         RowBox[{"MapThread", "[", 
          RowBox[{"BoyerLindquistr", ",", 
           RowBox[{"{", 
            RowBox[{"KSX", ",", "KSY", ",", "KSZ"}], "}"}]}], "]"}]}]}], ";", 
       "\n", 
       RowBox[{"CosBLTheta", " ", "=", " ", 
        RowBox[{"KSZ", "/", "BLR"}]}], ";", "\n", 
       RowBox[{"SinBLTheta", " ", "=", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"CosBLTheta", "^", "2"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"LeoXArr", " ", "=", " ", 
        RowBox[{"BLR", "*", "SinBLTheta"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LeoZArr", " ", "=", "KSZ"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "evaluate", " ", "the", " ", "solution"}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"MySolution", " ", "=", " ", 
        RowBox[{"Quiet", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"EvaluateLeoSolution", ",", 
           RowBox[{"{", 
            RowBox[{"LeoXArr", ",", "LeoZArr"}], "}"}]}], "]"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"PrintList", " ", "=", " ", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"LeoXArr", ",", "LeoZArr", ",", "MySolution"}], "}"}], 
          "]"}], "//", "TableForm"}]}], ";", "\n", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
         "\"\</Users/mokounkova/EDGB/InitialDataGeneration/ScalarField/Theta\>\
\"", "<>", 
          RowBox[{"ToString", "[", "MySpin", "]"}], "<>", 
          "\"\</Vars_Sphere\>\"", "<>", 
          RowBox[{"SpECFiles", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<.dat\>\""}], ",", 
         "PrintList", ",", "\"\<Table\>\""}], "]"}]}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.746188528196884*^9, 3.74618853235145*^9}, {
   3.746188669904923*^9, 3.7461886765156717`*^9}, {3.7461887066779213`*^9, 
   3.7461887982404337`*^9}, {3.746200279703271*^9, 3.746200296417425*^9}, 
   3.74622866718482*^9, {3.777042473757637*^9, 3.777042508022071*^9}, {
   3.777042553800242*^9, 3.777042555328478*^9}, 3.7770426459564447`*^9, {
   3.777046475961924*^9, 3.777046484679454*^9}, {3.777048170917035*^9, 
   3.777048171385408*^9}, {3.777049531160433*^9, 3.777049559013721*^9}, 
   3.777049591874692*^9, {3.777049683369425*^9, 3.777049685762452*^9}, {
   3.777049723546196*^9, 3.777049802131344*^9}, {3.777126445153246*^9, 
   3.777126471926284*^9}, {3.777131062965662*^9, 3.7771310643811626`*^9}, {
   3.777131136592794*^9, 3.7771311395383453`*^9}, {3.777131181626333*^9, 
   3.777131182693585*^9}, {3.777131224835492*^9, 3.777131274647246*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"b2d88be8-c302-45e5-9bd3-7268c7abd50c"],

Cell[CellGroupData[{

Cell[BoxData["0"], "Print",
 CellChangeTimes->{
  3.746200303526832*^9, 3.74620662002682*^9, 3.746228546970964*^9, 
   3.7462286953303556`*^9, 3.746229183517046*^9, 3.746229225943317*^9, 
   3.746229940680435*^9, 3.777042516383809*^9, 3.7770425693178453`*^9, 
   3.7770426167283*^9, {3.777042653621209*^9, 3.7770426782455797`*^9}, {
   3.777042915550035*^9, 3.7770429423631163`*^9}, {3.777044246806233*^9, 
   3.77704427380941*^9}, 3.777047189210224*^9, {3.777049661754395*^9, 
   3.7770496867918043`*^9}, {3.777049783397943*^9, 3.777049802869896*^9}, 
   3.7771265005301332`*^9, 3.777131079791575*^9, 3.777131147597579*^9, {
   3.777131186168*^9, 3.777131200288992*^9}, 3.777131301104499*^9, 
   3.7771313408538513`*^9, 3.777133892102356*^9, 3.7771339312623787`*^9},
 CellLabel->
  "During evaluation of \
In[69]:=",ExpressionUUID->"8c70d2f8-a144-4ef7-9b75-b727f221ee3e"],

Cell[BoxData["1"], "Print",
 CellChangeTimes->{
  3.746200303526832*^9, 3.74620662002682*^9, 3.746228546970964*^9, 
   3.7462286953303556`*^9, 3.746229183517046*^9, 3.746229225943317*^9, 
   3.746229940680435*^9, 3.777042516383809*^9, 3.7770425693178453`*^9, 
   3.7770426167283*^9, {3.777042653621209*^9, 3.7770426782455797`*^9}, {
   3.777042915550035*^9, 3.7770429423631163`*^9}, {3.777044246806233*^9, 
   3.77704427380941*^9}, 3.777047189210224*^9, {3.777049661754395*^9, 
   3.7770496867918043`*^9}, {3.777049783397943*^9, 3.777049802869896*^9}, 
   3.7771265005301332`*^9, 3.777131079791575*^9, 3.777131147597579*^9, {
   3.777131186168*^9, 3.777131200288992*^9}, 3.777131301104499*^9, 
   3.7771313408538513`*^9, 3.777133892102356*^9, 3.7771339312756*^9},
 CellLabel->
  "During evaluation of \
In[69]:=",ExpressionUUID->"a4da7939-9ee9-44ab-a4e8-1047109e3624"],

Cell[BoxData["2"], "Print",
 CellChangeTimes->{
  3.746200303526832*^9, 3.74620662002682*^9, 3.746228546970964*^9, 
   3.7462286953303556`*^9, 3.746229183517046*^9, 3.746229225943317*^9, 
   3.746229940680435*^9, 3.777042516383809*^9, 3.7770425693178453`*^9, 
   3.7770426167283*^9, {3.777042653621209*^9, 3.7770426782455797`*^9}, {
   3.777042915550035*^9, 3.7770429423631163`*^9}, {3.777044246806233*^9, 
   3.77704427380941*^9}, 3.777047189210224*^9, {3.777049661754395*^9, 
   3.7770496867918043`*^9}, {3.777049783397943*^9, 3.777049802869896*^9}, 
   3.7771265005301332`*^9, 3.777131079791575*^9, 3.777131147597579*^9, {
   3.777131186168*^9, 3.777131200288992*^9}, 3.777131301104499*^9, 
   3.7771313408538513`*^9, 3.777133892102356*^9, 3.77713393562819*^9},
 CellLabel->
  "During evaluation of \
In[69]:=",ExpressionUUID->"0c5087f8-dc96-40c4-8612-77851a81399f"],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{
  3.746200303526832*^9, 3.74620662002682*^9, 3.746228546970964*^9, 
   3.7462286953303556`*^9, 3.746229183517046*^9, 3.746229225943317*^9, 
   3.746229940680435*^9, 3.777042516383809*^9, 3.7770425693178453`*^9, 
   3.7770426167283*^9, {3.777042653621209*^9, 3.7770426782455797`*^9}, {
   3.777042915550035*^9, 3.7770429423631163`*^9}, {3.777044246806233*^9, 
   3.77704427380941*^9}, 3.777047189210224*^9, {3.777049661754395*^9, 
   3.7770496867918043`*^9}, {3.777049783397943*^9, 3.777049802869896*^9}, 
   3.7771265005301332`*^9, 3.777131079791575*^9, 3.777131147597579*^9, {
   3.777131186168*^9, 3.777131200288992*^9}, 3.777131301104499*^9, 
   3.7771313408538513`*^9, 3.777133892102356*^9, 3.777133940021006*^9},
 CellLabel->
  "During evaluation of \
In[69]:=",ExpressionUUID->"dafefe56-5c95-498e-a0f8-0a40bfea95c1"],

Cell[BoxData["4"], "Print",
 CellChangeTimes->{
  3.746200303526832*^9, 3.74620662002682*^9, 3.746228546970964*^9, 
   3.7462286953303556`*^9, 3.746229183517046*^9, 3.746229225943317*^9, 
   3.746229940680435*^9, 3.777042516383809*^9, 3.7770425693178453`*^9, 
   3.7770426167283*^9, {3.777042653621209*^9, 3.7770426782455797`*^9}, {
   3.777042915550035*^9, 3.7770429423631163`*^9}, {3.777044246806233*^9, 
   3.77704427380941*^9}, 3.777047189210224*^9, {3.777049661754395*^9, 
   3.7770496867918043`*^9}, {3.777049783397943*^9, 3.777049802869896*^9}, 
   3.7771265005301332`*^9, 3.777131079791575*^9, 3.777131147597579*^9, {
   3.777131186168*^9, 3.777131200288992*^9}, 3.777131301104499*^9, 
   3.7771313408538513`*^9, 3.777133892102356*^9, 3.777133944438572*^9},
 CellLabel->
  "During evaluation of \
In[69]:=",ExpressionUUID->"e6ba70b2-12a1-41e8-83b0-44c47b1c00a8"],

Cell[BoxData["5"], "Print",
 CellChangeTimes->{
  3.746200303526832*^9, 3.74620662002682*^9, 3.746228546970964*^9, 
   3.7462286953303556`*^9, 3.746229183517046*^9, 3.746229225943317*^9, 
   3.746229940680435*^9, 3.777042516383809*^9, 3.7770425693178453`*^9, 
   3.7770426167283*^9, {3.777042653621209*^9, 3.7770426782455797`*^9}, {
   3.777042915550035*^9, 3.7770429423631163`*^9}, {3.777044246806233*^9, 
   3.77704427380941*^9}, 3.777047189210224*^9, {3.777049661754395*^9, 
   3.7770496867918043`*^9}, {3.777049783397943*^9, 3.777049802869896*^9}, 
   3.7771265005301332`*^9, 3.777131079791575*^9, 3.777131147597579*^9, {
   3.777131186168*^9, 3.777131200288992*^9}, 3.777131301104499*^9, 
   3.7771313408538513`*^9, 3.777133892102356*^9, 3.777133948896278*^9},
 CellLabel->
  "During evaluation of \
In[69]:=",ExpressionUUID->"808a4165-c763-4015-86b3-44d28667546a"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7462345252633677`*^9, 3.746234527731331*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"574f58a5-81b5-4cf1-bda8-1ea746509af3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.746230500087967*^9, 3.74623074117982*^9},
 CellLabel->
  "In[57]:=",ExpressionUUID->"2846f1da-fd4d-4158-bde0-58d11069b63b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1149, 1243},
WindowMargins->{{132, Automatic}, {Automatic, 16}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
ShowSelection->True,
Magnification:>1.25 Inherited,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]

